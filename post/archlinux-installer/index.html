<!DOCTYPE html>
<html lang="" dir="ltr">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Archlinux-Installer使用教程 &middot; si9ma&#39;s blog</title>
  <meta name="description" content="Archlinux-Installer为ArchLinux快速安装脚本，支持配置备份，支持环境快速恢复" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
  <link rel="stylesheet" href="https://www.si9ma.com/css/main.min.css" />
  
  <style>
    body {
      background: #ecedef url("https://www.si9ma.com/img/bg.jpg") repeat;
    }
  </style>
</head>
  <body class="single-body">
    <nav class="nav-bar side-padding">
  <h1 class="nav-header"><a href="https://www.si9ma.com" class="nav-text">si9ma</a></h1>
  <div class="hamburger-menu">
    <button onclick="hamburgerMenuPressed.call(this)" aria-haspopup="true" aria-expanded="false" aria-controls="menu" aria-label="Menu">
      <span></span>
      <span></span>
    </button>
    <ul id="menu" class="hamburger-menu-overlay">
      <li><a href="https://www.si9ma.com" class="hamburger-menu-overlay-link">Home</a></li>
      <li><a href="https://www.si9ma.com/about/" class="hamburger-menu-overlay-link">About Me</a></li>
      <li><a href="https://www.si9ma.com/categories/c&#43;&#43;" class="hamburger-menu-overlay-link">C&#43;&#43;</a></li><li><a href="https://www.si9ma.com/categories/coolos" class="hamburger-menu-overlay-link">Coolos</a></li><li><a href="https://www.si9ma.com/categories/cs" class="hamburger-menu-overlay-link">Cs</a></li><li><a href="https://www.si9ma.com/categories/linux" class="hamburger-menu-overlay-link">Linux</a></li><li><a href="https://www.si9ma.com/categories/os" class="hamburger-menu-overlay-link">Os</a></li><li><a href="https://www.si9ma.com/categories/spring" class="hamburger-menu-overlay-link">Spring</a></li><li><a href="https://www.si9ma.com/categories/tool" class="hamburger-menu-overlay-link">Tool</a></li>
    </ul>
  </div>
</nav>
    <main class="content side-text-padding">
      <article class="post dropcase">
        <header class="post-header">
        	<h1 class="post-title">Archlinux-Installer使用教程</h1>
          <p class="post-date">Posted <time datetime="2018-03-15">Mar 15, 2018</time></p>
        </header>
        
        <picture class="post-figure">
            
            <source srcset="https://www.si9ma.com/img/archlinux-logo-black-1200dpi.94d8489023b3.png">
          <img src="https://www.si9ma.com/img/archlinux-logo-black-1200dpi.94d8489023b3.png" >
        </picture>
        
        <h3 id="about">About</h3>
<p>使用Linux也已经两年了，开始使用的是Ubuntu，后来各种折腾，换到了Archlinux，使用至今。在使用Archlinux过程中，各种折腾各种配置，各种快捷键，终于把Archlinux折腾成了自己觉得很好看，很好用的样子。但是问题就是，如果哪天我想重装我的Arch，我还得从头一个命令一个命令敲一遍。还得重新改各种配置，重新装各种常用的软件。虽然说从头敲一遍命令可以学到很多东西，但那是对于第一次装的时候。如果以后每次重装都重新敲一遍，岂不是很蠢，很浪费时间。所以呢，我就使用bash配合dialog工具，写了这个伪界面版本的Archlinux安装器。</p>
<h3 id="feature">Feature</h3>
<p>以下是这个安装器的一些特性:</p>
<ul>
<li>伪界面，相对纯纯的命令行，是不是友好那么点</li>
<li>支持KDE、Xfce、Gnome桌面系统的安装</li>
<li>支持Gnome桌面系统的简单配置</li>
<li>支持Gnome桌面系统的中文输入法(搜狗输入法)的安装</li>
<li>支持一些软件的配置的备份和恢复(可以添加自己的备份/恢复脚本)</li>
<li>支持Bios和UEFI两种启动方式</li>
<li>自动检测Windows启动项</li>
</ul>
<!-- raw HTML omitted -->
<h3 id="i-want-say">I Want Say</h3>
<p>Arch Linux主张“以用户为中心”，让用户自己去动手控制自己的系统，让用户自己动手去解决问题。它的安装过程就体现了这一点。我写这个安装器并不是想违背这个观点。我也认为作为开发人员，应该自己动手去解决遇到的问题，解决问题能帮助我们学到更多的东西。我写这个安装器是为了能够更快速地恢复自己的系统环境。也是为了能够帮助刚开始使用Arch的童鞋能够一点点帮助。感兴趣的童鞋可以修改这个安装器，加入自己的软件备份/恢复脚本。</p>
<h3 id="how-to-use">How To Use</h3>
<h4 id="制作arch启动盘">制作Arch启动盘</h4>
<p>首先，需要下载<code>Arch</code>安装<code>ios</code>包，怎么下载我就不多说了。然后找个启动盘制作工具，在<code>Windows</code>上，我比较喜欢的一个工具是<code>Rufus</code>。如果使用虚拟机的童鞋，就没必要制作启动盘了，直接使用<code>ios</code>包就行了。</p>
<h4 id="使用启动盘启动并连网">使用启动盘启动并连网</h4>
<p>怎么启动就不多说了。启动之后最重要的事就是连网，只有连上网才能继续后续的操作。直接使用网线连网并且不需要验证的话，一般启动之后就连上网了。如果是需要验证或使用<code>WIFI</code>的话就有点麻烦了。不会的童鞋可以参考我的文章(<a href="https://coolcodes.me/2018/03/15/how-to-connect-wifi-in-linux-command/">怎么在Linux使用命令行连接WIFI</a>)。怎么看是否连上网了呢？<code>ping</code>一下，比如<code>ping www.baidu.com</code>，如果<code>ping</code>能成功的话，那就是连上了。如果不成功的话，那&hellip;..，再检查检查 。</p>
<h4 id="开始安装">开始安装</h4>
<p>前面都是一些准备工作，接下来才是使用安装器。</p>
<p>在命令行中输入:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bash &lt;<span style="color:#f92672">(</span>curl https://raw.githubusercontent.com/si9ma/Archlinux-Installer/master/install.sh<span style="color:#f92672">)</span>
</code></pre></div><h4 id="选择键盘布局">选择键盘布局</h4>
<p><img src="https://www.si9ma.com/img/archlinux-installer/keymap-1.png" alt="keymap-1"></p>
<p>一般使用的都是US布局，所以选择No就行。但是如果你想使用其它布局的话就选择Yes，然后选择合适的布局。如下，</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/keymap-2.png" alt="keymap-2"></p>
<h4 id="硬盘分区">硬盘分区</h4>
<p>安装Arch之前，需要对硬盘进行分区，在分区之前一定要看好各个磁盘/分区的大小，避免在后续挂载分区的时候选错，然后格错分区。</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/partition-1.png" alt="partition-1"></p>
<h5 id="对于两种启动方式">对于两种启动方式</h5>
<ol>
<li>BIOS启动方式</li>
</ol>
<p>如果你的启动方式是BIOS，那么你应该把你的硬盘转换成MBR的，也就是说接下来的选择分区结构，你应该选择dos。</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/partition-bios.png" alt="partition-bios"></p>
<ol start="2">
<li>UEFI启动方式</li>
</ol>
<p>如果你的启动方式是UEFI，你必须有一个100M-200M大小的分区用作ESP分区。如果你电脑上之前有装过Windows，并且也是UEFI启动，那么已经存在一个EFI分区了，在后续的分区挂载时候不应该格式化该EFI分区，否则Windows就无法启动了。</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/uefi.png" alt="uefi"></p>
<h5 id="选择需要进行分区的硬盘">选择需要进行分区的硬盘</h5>
<p>如果有多个硬盘，将按照顺序进行分区:</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/partition-select.png" alt="partition-select"></p>
<h5 id="选择硬盘分区结构">选择硬盘分区结构</h5>
<p>如果你的硬盘是还没进行过分区的硬盘，会出现这个页面。如果你是BIOS启动，那么选择dos，如果是UEFI启动，那么选择gpt。</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/partition-label.png" alt="partition-label"></p>
<h5 id="对硬盘分区">对硬盘分区</h5>
<p>使用<code>New</code>创建新的分区，分区完成之后，记得<code>Write</code>，然后<code>Quit</code>完成分区。</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/partition-go.png" alt="partition-go"></p>
<h4 id="分区挂载">分区挂载</h4>
<p>选择需要单独挂载的文件目录，如果你的启动方式是UEFI,那么你必须单独挂载 <code>/boot</code>。我一般只挂载根目录<code>/</code>。你还可以添加<code>swap</code>分区。</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/fs-mount.png" alt="fs-mount"></p>
<h5 id="为每个选择的目录选择分区">为每个选择的目录选择分区</h5>
<p>请注意分区大小，一定不要选错分区，因为选择的分区后续将会被格式化。根据分区大小来选择正确的分区。<code>/dev/sda1(ext2) devtmpfs/16G--&gt;ext4</code>的意思是，该分区为<code>/dev/sda1</code>,大小为16G，当前文件系统格式为<code>devtmpfs</code>，将被格式化为<code>ext2</code>。请选择合适的文件系统格式，我一般选择<code>ext4</code>。</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/root-mount.png" alt="root-mount"></p>
<h5 id="对于boot">对于/boot</h5>
<p>如果你的启动方式是UEFI，那么/boot必须单独挂载到ESP分区上去，如果ESP分区是来自之前的Windows的安装，那么你不能格式化该分区，如图，你应该选择No</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/uefi-confirm.png" alt="uefi-confirm"></p>
<h5 id="对于swap分区">对于swap分区</h5>
<p><code>swap</code>分区有两种方式，一种是选择分区，另外一种是使用文件来实现。如果使用文件实现，那么选择<code>swapfile</code>。</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/swap.png" alt="swap"></p>
<h4 id="选择源">选择源</h4>
<p>先选择国家/地区</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/mirrors.png" alt="mirrors"></p>
<p>选择源，一般来说越靠前的源，速度会越快</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/mirrors-2.png" alt="mirrors-2"></p>
<h4 id="开始安装基本系统">开始安装基本系统</h4>
<p>等待基本系统安装完成&hellip;&hellip;</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/basic.png" alt="basic"></p>
<h4 id="选择时区">选择时区</h4>
<p>先选择地区，国内的童鞋选择<code>Asia</code></p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/timezone.png" alt="timezone"></p>
<p>再选择城市,国内童鞋选择<code>Shanghai</code></p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/timezone-location.png" alt="timezone-location"></p>
<h4 id="本地化">本地化</h4>
<p>先选择字符集，我一般选择<code>zh_CN.UTF-8</code>和<code>en_US.UTF-8</code></p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/locale.png" alt="locale"></p>
<p>然后是<code>System Locale</code>，建议先选择<code>en_US.UTF-8</code>，进入桌面系统后再更改桌面系统的<code>locale</code></p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/sys-locale.png" alt="sys-locale"></p>
<h4 id="基本配置">基本配置</h4>
<p>主机名</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/hostname.png" alt="hostname"></p>
<p>root密码</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/passwd.png" alt="passwd"></p>
<p>用户名，用户名中请不要有大写字母</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/user.png" alt="user"></p>
<p>用户密码</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/passwd-user.png" alt="passwd-user"></p>
<h4 id="其他安装">其他安装</h4>
<p>安装一些必要软件</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/other-install.png" alt="other-install"></p>
<h4 id="基本系统安装完成">基本系统安装完成</h4>
<p><img src="https://www.si9ma.com/img/archlinux-installer/basic-complete.png" alt="basic-complete"></p>
<h4 id="重启后启动arch">重启后启动Arch</h4>
<p><img src="https://www.si9ma.com/img/archlinux-installer/boot.png" alt="boot"></p>
<h4 id="登录进行后续安装">登录进行后续安装</h4>
<p>使用前面设置的用户进行登录，别使用root用户进行登录，使用root登录将导致后续安装失败</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/boot-go.png" alt="boot-go"></p>
<h4 id="启用aur">启用AUR</h4>
<p>AUR库并不是官方的源，但很多时候很好用。你也可以选择不启用。</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/aur.png" alt="aur"></p>
<p>选择源，国内用户选择archlinuxcn</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/aur-mirrors.png" alt="aur-mirrors"></p>
<h4 id="启用32位库">启用32位库</h4>
<p><code>Arch</code>已经不再支持32位的系统了，但依然可以在64位系统里使用32位的库。你也可以不启用</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/lib32.png" alt="lib32"></p>
<h4 id="安装桌面系统">安装桌面系统</h4>
<p>先安装显卡驱动，虚拟机用户可以安装对应的虚拟机驱动，intel用户一般都有intel的集成显卡，所以选择intel的驱动。Linux对<code>NVIDIA</code>显卡的驱动支持不是很好，所以如果你想使用<code>NVIDIA</code>显卡驱动的话，你自己之后慢慢折腾吧～</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/driver.png" alt="driver"></p>
<p>然后选择桌面系统，这里提供了三个桌面系统</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/desktop.png" alt="desktop"></p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/desktop-to.png" alt="desktop-to"></p>
<p>如果你安装了Gnome桌面系统，那么后续将会提供Gnome的配置.</p>
<h4 id="gnome桌面主题配置">Gnome桌面主题配置</h4>
<p>这部分可能比较慢，因为一些主题需要到国外网站上下载主题，<code>local</code>表示本地，<code>remote</code>表示需要下载。</p>
<h5 id="gtk主题">GTK主题</h5>
<p><img src="https://www.si9ma.com/img/archlinux-installer/gtk-theme.png" alt="gtk-theme"></p>
<h5 id="图标主题">图标主题</h5>
<p><img src="https://www.si9ma.com/img/archlinux-installer/icon.png" alt="icon"></p>
<h5 id="shell主题">Shell主题</h5>
<p><img src="https://www.si9ma.com/img/archlinux-installer/shell.png" alt="shell"></p>
<h4 id="gnome插件">Gnome插件</h4>
<p><img src="https://www.si9ma.com/img/archlinux-installer/plugin.png" alt="plugin"></p>
<h4 id="gnome中文输入法配置">Gnome中文输入法配置</h4>
<p>选择(1)将整个桌面系统都配置成中文的，并安装搜狗输入法。选择(2)只安装搜狗输入法，但系统环境是英文的，比如标题等。</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/chinese.png" alt="chinese"></p>
<h4 id="软件安装配置恢复">软件安装/配置恢复</h4>
<p>选择你需要安装的软件或需要恢复的配置，你也可以在<code>backup.conf</code>中添加需要的操作，并在<code>backup_script.sh</code>中实现备份方法，在<code>restore_script.sh</code>中实现安装/恢复操作。</p>
<p><img src="https://www.si9ma.com/img/archlinux-installer/app.png" alt="app"></p>
<h4 id="安装完成">安装完成</h4>
<p><img src="https://www.si9ma.com/img/archlinux-installer/done.png" alt="done"></p>
<h4 id="关于配置备份">关于配置备份</h4>
<p>执行<code>backup.sh</code>进行配置备份</p>
<hr>

      </article>
      <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "si9ma" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </main>
    <nav class="end-nav side-padding">
      
      <a ontouchstart="cardPressed.call(this)" ontouchend="cardReleased.call(this)" ontouchmove="cardReleased.call(this)" 
  href="https://www.si9ma.com/post/readline/" class="card blog-card" rel="bookmark" >
    
    <div class="card-img-container">
      <p class="card-img-overlay">Next Article</p>
      <picture>
        
        <source srcset="https://www.si9ma.com/img/linux-1-800x420.jpg">
        <img src="https://www.si9ma.com/img/linux-1-800x420.jpg" class="card-img" >
      </picture>
    </div>
    
  <article class="card-body">
    <h2 class="card-title">Linux中的Readline</h2>
    <p class="card-text">Linux中的Readline学习</p>
    <div class="card-subtext muted-text">
      <p>Posted <time datetime="2018-02-02 22:00">Feb 2, 2018</time></p>
      <p>#Linux </p>
    </div>
  </article>
</a>
      
    </nav>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>
<script src="https://www.si9ma.com/js/core.js"></script>
<script>
  hljs.initHighlightingOnLoad();
</script>
  </body>
</html>